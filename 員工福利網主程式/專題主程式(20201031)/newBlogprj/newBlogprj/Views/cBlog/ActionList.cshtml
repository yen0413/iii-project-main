@using Action.Models
@model IEnumerable<ActionViewModel>
@{
    Layout = null;
    ViewBag.Title = "ActionList";
    int count = 0;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - My ASP.NET Application</title>
    <link href="~/ScriptforActionList/css/Site.css" rel="stylesheet" type="text/css" />
    <link href="~/ScriptforActionList/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/ScriptforActionList/css/all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link href="~/spforaction/css/jquery-ui.min.css" rel="stylesheet" />
    <link rel="shortcut icon" type="image/x-icon" href="../assets/img/favicon.ico">
    <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/css/slicknav.css">
    <link rel="stylesheet" href="../assets/css/animate.min.css">
    <link rel="stylesheet" href="../assets/css/fontawesome-all.min.css">
    <link rel="stylesheet" href="../assets/css/themify-icons.css">
    <link rel="stylesheet" href="../assets/css/nice-select.css">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link href="~/spforaction/css/imglarge/magnific-popup.css" rel="stylesheet" />

    <style>
        body {
            padding-top: 0px;
            background-color: #91D4C2;
        }

        .bg-light {
            background-color: white !important;
            border-bottom: 1px solid #aeaeae;
        }

        .container {
            max-width: 1920px;
            min-width: 1080px;
            width: 99%;
            /*margin: 30px auto;*/
        }

        .ui-widget-header {
            background-color: lightblue !important;
        }

        .ui-dialog-content {
            background-color: #fefbeb !important;
        }

        .nav-link {
            font-family: arial,"Microsoft JhengHei","微軟正黑體",sans-serif !important;
            color: #555555 !important;
        }

        .fixed-center {
            position: fixed;
            top: 60px;
            left: 50%;
            margin-left: -25px;
            margin-top: -25px;
        }

        label {
            font-size: 15px;
        }

        tbody {
            font-size: 15px;
            text-align: center;
        }

        th {
            font-size: 18px;
            text-align: center;
            background-color: lightblue
        }

        td {
            font-size: 16px !important;
        }

        #table_id_wrapper {
            background-color: lightblue;
        }

        .dataTables_info {
            font-size: 15px;
        }

        #table_id_paginate {
            font-size: 15px;
        }

        .hh1 {
            display: flex;
            justify-content: center;
        }

        .h3Div {
            background-color: white;
            opacity: 0.8;
        }

        label {
            font-size: 15px !important;
            font-weight: bold !important;
        }

        input {
            background: white !important;
        }

        #locationLink {
            color: Highlight;
        }

            #locationLink:hover {
                color: blue;
            }
        /*================================================================*/
        .row {
            padding: -20px;
        }

        .push_right {
            display: flex;
            flex-direction: row-reverse;
        }

        .button_margin {
            margin: 10px;
        }

        .response_range {
            display: flex;
        }

        .main_BCC {
            background-color: #FFF8D7;
            border-radius: 5px;
        }

        .text_mragin {
            margin-right: 10px;
        }

        .figure_range {
            margin: 5px;
        }

        .header-area {
            background-color: white;
        }

        header {
            background-color: #91D4C2;
        }

        body {
            background-color: #d5f0f0;
            padding-top: 0px;
            padding-bottom: 0px;
        }

        hr {
            margin-top: 0px;
            margin-bottom: 0px;
        }

        .slicknav_nav {
            height: 420px;
        }


        .date {
            font-size: 20px;
            color: #000;
            text-align: center;
            vertical-align: middle;
            line-height: 30px;
        }

            .date > span {
                font-weight: 600
            }

            .date > i {
                font-size: 1.5em;
                margin-right: 5px
            }

            .date > * {
                vertical-align: middle
            }

        .loadimg {
            width: 16px;
        }

        .mfp-arrow-right {
            right: 10%;
        }

        .mfp-arrow-left {
            left: 10%;
        }

        .mfp-close {
            font-size: 70px !important;
        }

        .main-menu {
            float: left !important;
        }
    </style>
</head>
<body>
    <header>

        <div class="header-area" style="background-color: white;">
            <div class="main-header ">
                <div class="header-bottom  header-sticky">
                    <div class="container">
                        <div class="row align-items-center">

                            <div class="col-xl-2 col-lg-2 col-md-1">
                                <div class="logo">
                                    <a href="#"><img src="../assets/img/Gladxy_co._LOGO_Small.png" alt=""></a>
                                </div>
                            </div>
                            <h3 class="col-xl-2 col-lg-4 col-md-3" style="display:flex;justify-content:center;">員工福利網</h3>
                            <div class="col-xl-8 col-lg-6 col-md-8">

                                <div class="main-menu f-right d-none d-lg-block">
                                    <nav>
                                        <ul id="navigation">
                                            <li><a href="/cBlog/BlogList">部落格</a></li>
                                            <li><a href="~/forumtestpage.html">討論區</a></li>
                                            <li class="nav-item dropdown">
                                                <a class="nav-link dropdown-toggle" href="/cBlog/PurchaseList" id="navbarDropdown"
                                                   role="button" data-toggle="dropdown" aria-haspopup="true"
                                                   aria-expanded="false">
                                                    揪團GO
                                                </a>
                                                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                                    <a class=" dropdown-item" href="/cBlog/Purchase_Open" style="padding: 10px;">
                                                        我要開團
                                                    </a>
                                                    <div class="dropdown-divider"></div>
                                                    <a class=" dropdown-item" href="/cBlog/Purchase_OpenList" style="padding: 10px;">
                                                        開團紀錄
                                                    </a>
                                                    <div class="dropdown-divider"></div>
                                                    <a class="dropdown-item" href="/cBlog/Purchase_FollowList" style="padding: 10px;">
                                                        我的跟團
                                                    </a>


                                                </div>
                                            </li>

                                            <li class="nav-item dropdown" id="actionLi">
                                                <a class="nav-link dropdown-toggle" href="/cBlog/Action" id="navbarDropdown"
                                                   role="button" data-toggle="dropdown" aria-haspopup="true"
                                                   aria-expanded="false">
                                                    活動區
                                                </a>
                                                <div id="actionArea" class="dropdown-menu" aria-labelledby="navbarDropdown">
                                                    <a class=" dropdown-item" href="/cBlog/Action" style="padding: 10px;">
                                                        回活動平台
                                                    </a>
                                                    <div class="dropdown-divider"></div>
                                                    <a class=" dropdown-item" href="/cBlog/aCreate" style="padding: 10px;">
                                                        舉辦活動
                                                    </a>
                                                    <div class="dropdown-divider"></div>
                                                    <a class=" dropdown-item" href="/cBlog/ActionList" style="padding: 10px;">
                                                        我舉辦的活動清單
                                                    </a>
                                                    <div class="dropdown-divider"></div>
                                                    <a class=" dropdown-item" href="/cBlog/BookingListView" style="padding: 10px;">
                                                        我參加的活動清單
                                                    </a>

                                                </div>
                                            </li>
                                            <li>歡迎 @ViewBag.username</li>
                                            <li class="nav-item dropdown">
                                                <a class="nav-link dropdown-toggle" href="/cBlog/PurchaseList" id="navbarDropdown"
                                                   role="button" data-toggle="dropdown" aria-haspopup="true"
                                                   aria-expanded="false">
                                                    會員專區
                                                </a>
                                                <div class="dropdown-menu" aria-labelledby="navbarDropdown">

                                                    <a class=" dropdown-item" href="/cBlog/Purchase_OpenList" style="padding: 10px;">
                                                        我的開團
                                                    </a>
                                                    <div class="dropdown-divider"></div>
                                                    <a class=" dropdown-item" href="/cBlog/Purchase_FollowList" style="padding: 10px;">
                                                        我的跟團
                                                    </a>

                                                    <div class="dropdown-divider"></div>
                                                    <a class="dropdown-item" href="/cBlog/MemberDataEdit/@ViewBag.enumber2" style="padding: 10px;">
                                                        修改資料
                                                    </a>
                                                    <div class="dropdown-divider"></div>
                                                    <a class="dropdown-item" href="/cBlog/Vote" style="padding: 10px;">
                                                        我的投票
                                                    </a>

                                                </div>
                                            </li>
                                            <li><a href="/cBlog/LogOut">登出</a></li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="mobile_menu d-block d-lg-none"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container body-content">

        @if (ViewBag.enumber2 == 2059)
        {
            //管理者
            <h1 class="h3Div" style=" color: black; font-weight: bolder;text-align:center;">
                所有活動項目
            </h1>
            using (Html.BeginForm("ActionList", "cBlog", FormMethod.Post, new { enctype = "multipart/form-data" }))
            {
                @Html.AntiForgeryToken()
                <div class="row" style="margin-top:50px;margin-bottom:50px;margin-top:10px;">
                    <div style="float:left;margin-left:23px;margin-top:10px;">
                        <label class="col-form-label" style="font-size:20px;font-weight:700">活動名稱</label>
                    </div>
                    <div style="float:left;margin-left:3px;margin-top:10px;">
                        <input id="keyword" name="keyword" value="@ViewBag.keyword" class="form-control" style="max-width:500px;min-width:300px;" placeholder="請輸入活動名稱">
                    </div>
                    <div style="float:left;margin-left:20px;margin-top:10px;">
                        <div style="float:left;margin-left:3px;">
                            <label class="col-form-label" style="font-size:20px;font-weight:700">活動起迄</label>
                        </div>
                        <div style="float:left;margin-left:3px;">
                            <input id="startdate" name="startdate" value="@ViewBag.startdate" readonly class="form-control datepicker" style="width:110px;background-color:white;">
                        </div>
                        <span style="float:left;margin-left:5px;font-size:23px;">
                            ~
                        </span>
                        <div style="float:left;margin-left:3px;">
                            <input id="enddate" name="enddate" value="@ViewBag.enddate" readonly class="form-control datepicker" style="width:110px;background-color:white;">
                        </div>
                    </div>

                    <div style="float:left;margin-left:5px;">
                    </div>
                    <div style="float:left;margin-left:25px;margin-top:10px;">
                        <button id="btnSearch" class="btn " type="submit" style="width:80px;font-size:20px;background-color:midnightblue;color:white;padding:20px !important">搜尋</button>
                        <button id="btnClear" class="btn " type="button" style="width:80px;font-size:20px;background-color:midnightblue;color:white;padding:20px !important">清除</button>
                        @*<button id="btnExport" class="btn " type="button" style="width:150px;font-size:20px;background-color:darkcyan;color:white;padding:20px !important">匯出清單</button>*@
                    </div>

                </div>
            }
        }
        else
        {
            //一般使用者
            <h1 class="h3Div" style=" color: black; font-weight: bolder;text-align:center;">
                我舉辦的活動清單
                <a onclick="goBack()" class="btn" style="padding:20px;font-size:16px; font-weight:bolder; border-radius:5px;background-color:#4CAF50;color:aliceblue;float:left;margin-left:20px;width:120px;">
                    回上一頁
                </a>
            </h1>
        }

        <table id="table_id" class="diplay table-hover table-bordered">
            <thead>
                <tr>
                    <th>序號</th>
                    <th>活動照片</th>
                    <th style="width:90px !important;">活動名稱</th>
                    <th style="width:75px !important;">活動內容</th>
                    <th style="width:180px !important;">活動地點</th>
                    <th>活動起日</th>
                    <th>活動迄日</th>
                    <th>編輯</th>
                </tr>
            </thead>
            <tbody>
                @if (Model != null)
                {
                    if (Model.ToList().Count > 0)
                    {
                        foreach (var item in Model)
                        {
                            count++;

                            <tr>
                                <td class="orderCount"> @count.ToString()</td>
                                <td>
                                    @*<img width="230" height="140" src="@item.EventImage">*@

                                    <div class="popup-gallery thumbnail">
                                        <a href="@item.EventImage" title="@item.EventName">
                                            <img src="@item.EventImage" style="width:150px;height:100px;">
                                        </a>
                                    </div>

                                </td>
                                <td>@item.EventName</td>
                                <td>
                                    <button class="opener" style="border-radius:5px;background-color:#3131a5;color:aliceblue;" data-content="@item.EventContent">
                                        詳細內容
                                    </button>

                                </td>
                                <td>
                                    @*<a id="locationLink" href="https://www.google.com/maps/embed/v1/place?key=AIzaSyCFlKPy1x-SwqwmwtVymtk5wSLHAoaDibI&q=@item.EventLocation&zoom=14">@item.EventLocation</a>*@
                                    <label>@item.EventLocation</label>
                                    <iframe width="150" height="130" frameborder="0" style="border:0" src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCFlKPy1x-SwqwmwtVymtk5wSLHAoaDibI&q=@item.EventLocation&zoom=14" allowfullscreen>89890</iframe>
                                </td>
                                <td>@item.EventStartDate.Value.ToString("yyyy-MM-dd HH:mm")</td>
                                <td>@item.EventEndDate.Value.ToString("yyyy-MM-dd HH:mm")</td>
                                <td>
                                    @*<i class="fas fa-edit"></i>*@@Html.ActionLink("修改", "aEdit", new { id = item.Event_ID }, new { OnClick = "return confirm('確定要修改嗎?')", @class = "btn btn-primary", @style = "font-size: 16px" }) <br> <br>
                                    @*<i class="fas fa-trash-alt"></i>*@@Html.ActionLink("刪除", "aDelete", new { id = item.Event_ID }, new { OnClick = "return confirm('確定要刪除嗎?')", @class = "btn btn-danger", @style = "font-size: 16px" })
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="9" style="text-align:center;"> 目前無創立的活動 </td>
                        </tr>
                    }
                }
            </tbody>
        </table>

    </div>
    <footer>
        <div class="footer_range footer-area footer-padding footer-bg"
             data-background="../assets/img/footer_bg.jpg">
            <div class="container">
                <div class="footer-end-range footer_link">
                    <div class="col-xl-7 col-lg-7 col-md-7">
                        <div class="footer-end-left ">
                            <a href="#">公司主頁</a>
                            <a href="#">福委會主頁</a>
                            <a href="#">與我聯繫</a>
                            <a href="#">聲明事項</a>
                        </div>
                    </div>

                    <div class="col-xl-5 col-lg-5 col-md-5">
                        <div class="footer-social f-right">
                            <a href="#"><i class="fab fa-twitter"></i></a>
                            <a href="#"><i class="fab fa-facebook-f"></i></a>
                            <a href="#"><i class="fab fa-behance"></i></a>
                            <a href="#"><i class="fas fa-globe"></i></a>
                        </div>
                    </div>
                </div>
                <div class="footer-end-range">
                    <P>© 2020 Gladxy Daily. All rights reserved</P>
                </div>
            </div>

        </div>
    </footer>


    <div id="dialog" title="活動內容" style="display:none; font-size:20px;">
        <p id="content"></p>
    </div>

    <script src="~/spforaction/js/all.min.js"></script>
    <script src="~/spforaction/js/jquery-3.0.0.min.js"></script>
    <script src="~/spforaction/js/jquery-ui.min.js"></script>
    <script src="~/spforaction/js/modernizr-2.6.2.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
    <script src="~/spforaction/js/jquery-ui.js"></script>


    <script>
        function goBack() {
            window.history.back();
        }
    </script>

    <script>
        $(function () {
            $("#dialog").dialog({
                autoOpen: false,
                height: 200,
                width: 500,
                hide: {
                    effect: "puff ",
                    duration: 800
                },
                show: {
                    effect: "puff ",
                    duration: 800
                }
            });


        });
    </script>
    <script>
        $(document).ready(function () {
            $('#table_id').DataTable();
        });
        let table = $('#table_id').DataTable({
            language: {
                url: "@Url.Content("~/Content/i18n/Chinese-traditional.json")"
            },
            "order": [[5, "desc"]],
            "lengthMenu": [[5, 10, 15], [5, 10, 15]],
            "drawCallback": function () {
                reOrder();
                $(".opener").unbind().on("click", function () {
                    $("#dialog").dialog("open");
                    $("#dialog").html($(this).data('content'));
                });
                //小圖變大圖
                $('.popup-gallery').magnificPopup({
                    delegate: 'a',
                    type: 'image',
                    tLoading: 'Loading image #%curr%...',
                    mainClass: 'mfp-img-mobile',
                    gallery: {
                        enabled: true,
                        navigateByImgClick: true,
                        preload: [0, 1] // Will preload 0 - before current, and 1 after the current image
                    },
                    image: {
                        tError: '<a href="%url%">The image #%curr%</a> could not be loaded.',
                        titleSrc: function (item) {
                            return item.el.attr('title') + '';
                        }
                    }
                });
                   var mb_id = '@ViewBag.enumber2';
                    if (mb_id == '2059') {
                        $('.dataTables_filter').remove();                   
                    }
            }
        })
        $("#table_id").find("thead").on('click', 'th', function () {
            reOrder();
        });

        function reOrder() {
            $('.orderCount').each(function (index, item) {
                $(this).text(index + 1);
            });
        }

    </script>


    <script src="/../assets/js/popper.min.js"></script>
    @*<script src="/../assets/js/bootstrap.min.js"></script>*@
    <script src="/../assets/js/jquery.slicknav.min.js"></script>
    <script src="/../assets/js/owl.carousel.min.js"></script>
    <script src="/../assets/js/slick.min.js"></script>
    <script src="/../assets/js/wow.min.js"></script>
    <script src="/../assets/js/animated.headline.js"></script>
    <script src="/../assets/js/jquery.magnific-popup.js"></script>
    <script src="/../assets/js/jquery.scrollUp.min.js"></script>
    <script src="/../assets/js/jquery.nice-select.min.js"></script>
    <script src="/../assets/js/jquery.sticky.js"></script>

    <script src="/../assets/js/main.js"></script>
    <script src="~/spforaction/css/imglarge/jquery.magnific-popup.js"></script>
    <script>
        $(function () {
            var mb_id = '@ViewBag.enumber2';
            if (mb_id == '2059') {
                $('#actionArea').remove();
                $('#actionLi').html('<a  href="/cBlog/Action"  data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">活動管理</a>');
                $('.container').find('h1').text('所有活動項目')
            }
            $(".datepicker").datepicker({ dateFormat: "yy-mm-dd" }).val();
            //清除
            $('#btnClear').click(function () {
                $('form input').val('');
            });

            $('#btnExport').on('click', function (e) {
              var e = document.createElement('a');
                  e.href = "@Href("~/cBlog/ExportActionList/")" + "?keyword=" + encodeURIComponent($('#keyword').val()) + "&sd=" + $('#startdate').val() + '&ed=' + $('#enddate').val() ;
                  e.target = '_blank';
                  document.body.appendChild(e);
                  e.click();
            });
        })

    </script>

</body>
</html>


